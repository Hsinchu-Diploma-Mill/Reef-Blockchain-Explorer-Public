(this["webpackJsonpreef-blockchain-explorer"]=this["webpackJsonpreef-blockchain-explorer"]||[]).push([[0],{297:function(e){e.exports=JSON.parse('[{"inputs":[],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"inputs":[{"internalType":"uint256","name":"folderIdx","type":"uint256"},{"internalType":"string","name":"fileName","type":"string"},{"internalType":"string","name":"cid","type":"string"},{"internalType":"uint256","name":"time","type":"uint256"},{"internalType":"uint256","name":"size","type":"uint256"}],"name":"addExcel","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"string","name":"","type":"string"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"excelMap","outputs":[{"internalType":"string","name":"cid","type":"string"},{"internalType":"uint256","name":"time","type":"uint256"},{"internalType":"uint256","name":"size","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"folderArray","outputs":[{"internalType":"string","name":"name","type":"string"},{"internalType":"uint256","name":"last","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"folderIdx","type":"uint256"},{"internalType":"string","name":"name","type":"string"},{"internalType":"uint256","name":"idx","type":"uint256"}],"name":"getExcel","outputs":[{"components":[{"internalType":"string","name":"cid","type":"string"},{"internalType":"uint256","name":"time","type":"uint256"},{"internalType":"uint256","name":"size","type":"uint256"}],"internalType":"struct StoreTree.excelData","name":"","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"folderIdx","type":"uint256"},{"internalType":"string","name":"name","type":"string"}],"name":"getExcelLength","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"folderIdx","type":"uint256"},{"internalType":"uint256","name":"excelIdx","type":"uint256"}],"name":"getFolderExcel","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"folderIdx","type":"uint256"}],"name":"getFolderExcelLength","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"folderIdx","type":"uint256"},{"internalType":"uint256","name":"queryIdx","type":"uint256"}],"name":"getFolderList","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"folderIdx","type":"uint256"}],"name":"getFolderListLength","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"folderIdx","type":"uint256"}],"name":"getFolderName","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_addr","type":"address"}],"name":"isAdmin","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"folderIdx","type":"uint256"},{"internalType":"string","name":"fileName","type":"string"},{"internalType":"string","name":"cid","type":"string"},{"internalType":"uint256","name":"time","type":"uint256"},{"internalType":"uint256","name":"size","type":"uint256"}],"name":"newExcel","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"folderIdx","type":"uint256"},{"internalType":"string","name":"name","type":"string"}],"name":"newFolder","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"folderIdx","type":"uint256"},{"internalType":"uint256","name":"idx","type":"uint256"}],"name":"removeExcel","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"folderIdx","type":"uint256"},{"internalType":"uint256","name":"idx","type":"uint256"}],"name":"removeFolder","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_addr","type":"address"},{"internalType":"bool","name":"_type","type":"bool"}],"name":"setAdmin","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"}]')},393:function(e,t,n){},410:function(e,t){},413:function(e,t){},416:function(e,t){},420:function(e,t){},421:function(e,t){},447:function(e,t){},449:function(e,t){},458:function(e,t){},460:function(e,t){},471:function(e,t){},473:function(e,t){},487:function(e,t){},515:function(e,t){},516:function(e,t){},590:function(e,t){},592:function(e,t){},599:function(e,t){},600:function(e,t){},746:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n(293),r=n.n(a),o=(n(393),n(48)),s=n(108),u=n(12),l=n(10),c=n(294),p=n.n(c),d=n(297),y=n(298),m=n.n(y),f=function(){function e(){Object(u.a)(this,e),this.contractAddr="0xa1BCe629767D23cb719990FB8aDF54a2B4Da41d1",this.web3=void 0,this.contract=void 0,this.base="https://quorum-blockchain.yikuo.dev/api/",this.rpc="https://rpc.quorum-blockchain.yikuo.dev/",this.web3=new p.a(this.rpc),this.contract=new this.web3.eth.Contract(d,this.contractAddr)}return Object(l.a)(e,[{key:"listFolders",value:function(){var e=Object(s.a)(Object(o.a)().mark((function e(t){var n,i,a,r,s,u,l,c,p;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.contract.methods.getFolderListLength(t).call();case 2:for(n=e.sent,i=[],a=0;a<n;a++)i.push(this.contract.methods.getFolderList(t,a).call());return e.next=7,Promise.all(i);case 7:for(r=e.sent,i=[],s=0;s<r.length;s++)i.push(this.contract.methods.getFolderName(r[s]).call());return e.next=12,Promise.all(i);case 12:for(u=e.sent,l=[],c=0;c<r.length;c++)p={folderIdx:r[c],name:u[c]},l.push(p);return e.abrupt("return",l);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"listFolderFiles",value:function(){var e=Object(s.a)(Object(o.a)().mark((function e(t){var n,i,a,r,s,u,l;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.contract.methods.getFolderExcelLength(t).call();case 2:for(n=e.sent,i=[],a=0;a<n;a++)i.push(this.contract.methods.getFolderExcel(t,a).call());return e.next=7,Promise.all(i);case 7:for(r=e.sent,s=[],u=0;u<r.length;u++)l={folderIdx:t,name:r[u]},s.push(l);return e.abrupt("return",s);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"listFiles",value:function(){var e=Object(s.a)(Object(o.a)().mark((function e(t){var n,i,a,r,s,u,l;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.contract.methods.getExcelLength(t.folderIdx,t.name).call();case 2:for(n=e.sent,console.log("TEST:",n),i=[],a=0;a<n;a++)i.push(this.contract.methods.getExcel(t.folderIdx,t.name,a).call());return e.next=8,Promise.all(i);case 8:for(r=e.sent,s=[],u=0;u<r.length;u++)l={uuid:r[u].cid,name:t.name,size:+r[u].size,lastModified:new Date(1e3*+r[u].time)},s.push(l);return e.abrupt("return",s);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"downloadFile",value:function(){var e=Object(s.a)(Object(o.a)().mark((function e(t,n){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:m()({url:this.base+"data/".concat(t,"/download"),method:"GET",responseType:"blob"}).then((function(e){var t=window.URL.createObjectURL(new Blob([e.data])),i=document.createElement("a");i.href=t,i.setAttribute("download",n),document.body.appendChild(i),i.click(),document.body.removeChild(i)}));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),b=n(819),h=n(820),x=n(821),g=n(814),j=n(822),v=n(373),T=n.n(v),O=n(23),w=n(27),F=n(302),I=n(815),M=n(816),k=n(7),E=n(129),L=n(5);Object(k.h)({iconComponent:E.a});var C=function(e){var t=Object(i.useState)(null),n=Object(O.a)(t,2),a=n[0],r=n[1],o=Object(i.useState)({path:[{index:0,name:"Root"}],index:0}),s=Object(O.a)(o,2),u=s[0],l=s[1],c=Object(i.useState)(null),p=Object(O.a)(c,2),d=p[0],y=p[1],m=Object(i.useState)([null]),f=Object(O.a)(m,2),b=f[0],h=f[1];Object(i.useEffect)((function(){!function(e,t,n,i){n([null]);var a=e.listFolders(t.index),r=e.listFolderFiles(t.index);Promise.all([a,r]).then((function(e){var t=e[0],i=e[1],a=t.map((function(e){return{id:e.folderIdx.toString(),name:e.name,isDir:!0}})),r=i.map((function(e){return{id:"".concat(e.folderIdx,"/").concat(e.name),name:e.name,isDir:!1}}));console.log(a.concat(r)),n(a.concat(r))})).catch((function(e){console.log(e),i({message:"".concat(e),severity:"error"})}))}(e.reefRepository,u,h,r)}),[u,e.reefRepository]);var x=Object(i.useState)(null),g=Object(O.a)(x,2),j=g[0],v=g[1];Object(i.useEffect)((function(){!function(e,t,n,i){null==t?n(null):(n([null]),e.listFiles(t).then((function(e){var t=e.map((function(e){return{id:e.uuid,name:e.name,modDate:e.lastModified,size:e.size,isDir:!1}}));n(t)})).catch((function(e){console.log(e),i({message:"".concat(e),severity:"error"})})))}(e.reefRepository,d,v,r)}),[d,e.reefRepository]);var T=function(e,t){return Object(i.useMemo)((function(){var n=e.path.map((function(e){return{id:e.index.toString(),name:e.name,isDir:!0}}));return null!=t&&n.push({id:"".concat(t.folderIdx,"/").concat(t.name),name:t.name+" (History)",isDir:!1}),console.log(n),n}),[e,t])}(u,d),E=function(e,t,n,a,r,o){return Object(i.useCallback)((function(i){if(i.id===k.a.OpenFiles.id){var s=i.payload,u=s.targetFile,l=s.files,c=null!==u&&void 0!==u?u:l[0];if(console.log(c),c)if(c.isDir){var p,d=!1,y=Object(F.a)(n.path.entries());try{for(y.s();!(p=y.n()).done;){var m=Object(O.a)(p.value,2),f=m[0];if(m[1].index.toString()===c.id){d=!0,r({path:n.path.slice(0,f+1),index:parseInt(c.id)}),o(null);break}}}catch(j){y.e(j)}finally{y.f()}d||(r({path:[].concat(Object(w.a)(n.path),[{index:parseInt(c.id),name:c.name}]),index:parseInt(c.id)}),o(null))}else if(t)a({message:"The file is now downloading...",severity:"info"}),e.downloadFile(c.id,c.name);else{var b=c.id.split("/",1),h=Object(O.a)(b,2),x=h[0],g=h[1];o({folderIdx:parseInt(x),name:g})}}console.log(i)}),[r,n.path,o,t,a,e])}(e.reefRepository,null!=d,u,r,l,y);return Object(L.jsxs)("div",{style:{height:"80vh"},children:[Object(L.jsxs)(k.c,{instanceId:e.instanceId,files:null!==j&&void 0!==j?j:b,folderChain:T,onFileAction:E,defaultFileViewActionId:k.a.EnableListView.id,children:[Object(L.jsx)(k.f,{}),Object(L.jsx)(k.g,{}),Object(L.jsx)(k.e,{}),Object(L.jsx)(k.d,{})]}),Object(L.jsx)(I.a,{open:null!==a,autoHideDuration:3e3,onClose:function(){r(null)},ClickAwayListenerProps:{onClickAway:function(){}},children:Object(L.jsx)(M.a,{onClose:function(){r(null)},severity:null===a||void 0===a?void 0:a.severity,sx:{width:"100%"},children:null===a||void 0===a?void 0:a.message})})]})};var D=function(){var e=new f;return Object(L.jsxs)(b.a,{sx:{flexGrow:1},children:[Object(L.jsx)(h.a,{position:"static",children:Object(L.jsxs)(x.a,{children:[Object(L.jsx)(g.a,{size:"large",edge:"start",color:"inherit","aria-label":"menu",sx:{mr:2},children:Object(L.jsx)(T.a,{})}),Object(L.jsx)(j.a,{variant:"h6",component:"div",sx:{flexGrow:1},children:"Reef Blockchain Explorer"})]})}),Object(L.jsx)("div",{style:{padding:32},children:Object(L.jsx)(C,{instanceId:"reef-browser",reefRepository:e})})]})},S=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,825)).then((function(t){var n=t.getCLS,i=t.getFID,a=t.getFCP,r=t.getLCP,o=t.getTTFB;n(e),i(e),a(e),r(e),o(e)}))};Object(k.h)({iconComponent:E.a}),r.a.createRoot(document.getElementById("root")).render(Object(L.jsx)(D,{})),S()}},[[746,1,2]]]);
//# sourceMappingURL=main.76aa914f.chunk.js.map