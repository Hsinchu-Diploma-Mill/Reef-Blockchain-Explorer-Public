(this["webpackJsonpreef-blockchain-explorer"]=this["webpackJsonpreef-blockchain-explorer"]||[]).push([[0],{300:function(e){e.exports=JSON.parse('[{"inputs":[],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"inputs":[{"internalType":"uint256","name":"folderIdx","type":"uint256"},{"internalType":"string","name":"fileName","type":"string"},{"internalType":"string","name":"cid","type":"string"},{"internalType":"uint256","name":"time","type":"uint256"},{"internalType":"uint256","name":"size","type":"uint256"}],"name":"addExcel","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"string","name":"","type":"string"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"excelMap","outputs":[{"internalType":"string","name":"cid","type":"string"},{"internalType":"uint256","name":"time","type":"uint256"},{"internalType":"uint256","name":"size","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"folderArray","outputs":[{"internalType":"string","name":"name","type":"string"},{"internalType":"uint256","name":"last","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"folderIdx","type":"uint256"},{"internalType":"string","name":"name","type":"string"},{"internalType":"uint256","name":"idx","type":"uint256"}],"name":"getExcel","outputs":[{"components":[{"internalType":"string","name":"cid","type":"string"},{"internalType":"uint256","name":"time","type":"uint256"},{"internalType":"uint256","name":"size","type":"uint256"}],"internalType":"struct StoreTree.excelData","name":"","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"folderIdx","type":"uint256"},{"internalType":"string","name":"name","type":"string"}],"name":"getExcelLength","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"folderIdx","type":"uint256"},{"internalType":"uint256","name":"excelIdx","type":"uint256"}],"name":"getFolderExcel","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"folderIdx","type":"uint256"}],"name":"getFolderExcelLength","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"folderIdx","type":"uint256"},{"internalType":"uint256","name":"queryIdx","type":"uint256"}],"name":"getFolderList","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"folderIdx","type":"uint256"}],"name":"getFolderListLength","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"folderIdx","type":"uint256"}],"name":"getFolderName","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_addr","type":"address"}],"name":"isAdmin","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"folderIdx","type":"uint256"},{"internalType":"string","name":"fileName","type":"string"},{"internalType":"string","name":"cid","type":"string"},{"internalType":"uint256","name":"time","type":"uint256"},{"internalType":"uint256","name":"size","type":"uint256"}],"name":"newExcel","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"folderIdx","type":"uint256"},{"internalType":"string","name":"name","type":"string"}],"name":"newFolder","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"folderIdx","type":"uint256"},{"internalType":"uint256","name":"idx","type":"uint256"}],"name":"removeExcel","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"folderIdx","type":"uint256"},{"internalType":"uint256","name":"idx","type":"uint256"}],"name":"removeFolder","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_addr","type":"address"},{"internalType":"bool","name":"_type","type":"bool"}],"name":"setAdmin","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"}]')},402:function(e,t,n){},419:function(e,t){},422:function(e,t){},425:function(e,t){},429:function(e,t){},430:function(e,t){},456:function(e,t){},458:function(e,t){},467:function(e,t){},469:function(e,t){},480:function(e,t){},482:function(e,t){},496:function(e,t){},524:function(e,t){},525:function(e,t){},599:function(e,t){},601:function(e,t){},608:function(e,t){},609:function(e,t){},755:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n(296),r=n.n(a),o=(n(402),n(50)),s=n(109),l=n(11),u=n(10),c=n(297),p=n.n(c),d=n(300),y=n(301),m=n.n(y),f=function(){function e(){Object(l.a)(this,e),this.contractAddr="0x5308132EB6826ef1FCC8B1F1f31f0675bC8Fc646",this.web3=void 0,this.contract=void 0,this.base="https://quorum-blockchain.yikuo.dev/api/",this.rpc="https://rpc.quorum-blockchain.yikuo.dev/",this.web3=new p.a(this.rpc),this.contract=new this.web3.eth.Contract(d,this.contractAddr)}return Object(u.a)(e,[{key:"listFolders",value:function(){var e=Object(s.a)(Object(o.a)().mark((function e(t){var n,i,a,r,s,l,u,c,p;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.contract.methods.getFolderListLength(t).call();case 2:for(n=e.sent,i=[],a=0;a<n;a++)i.push(this.contract.methods.getFolderList(t,a).call());return e.next=7,Promise.all(i);case 7:for(r=e.sent,i=[],s=0;s<r.length;s++)i.push(this.contract.methods.getFolderName(r[s]).call());return e.next=12,Promise.all(i);case 12:for(l=e.sent,u=[],c=0;c<r.length;c++)p={folderIdx:r[c],name:l[c]},u.push(p);return e.abrupt("return",u);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"listFolderFiles",value:function(){var e=Object(s.a)(Object(o.a)().mark((function e(t){var n,i,a,r,s,l,u;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.contract.methods.getFolderExcelLength(t).call();case 2:for(n=e.sent,i=[],a=0;a<n;a++)i.push(this.contract.methods.getFolderExcel(t,a).call());return e.next=7,Promise.all(i);case 7:for(r=e.sent,s=[],l=0;l<r.length;l++)u={folderIdx:t,name:r[l]},s.push(u);return e.abrupt("return",s);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"listFiles",value:function(){var e=Object(s.a)(Object(o.a)().mark((function e(t){var n,i,a,r,s,l,u;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t.folderIdx),console.log(t.name),e.next=4,this.contract.methods.getExcelLength(t.folderIdx,t.name).call();case 4:for(n=e.sent,console.log("TEST:",n),i=[],a=0;a<n;a++)i.push(this.contract.methods.getExcel(t.folderIdx,t.name,a).call());return e.next=10,Promise.all(i);case 10:for(r=e.sent,s=[],l=0;l<r.length;l++)u={uuid:r[l].cid,name:t.name,size:+r[l].size,lastModified:new Date(+r[l].time)},s.push(u);return e.abrupt("return",s);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"downloadFile",value:function(){var e=Object(s.a)(Object(o.a)().mark((function e(t,n){var i,a,r;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m()({url:this.base+"data/".concat(t,"/download"),method:"GET",responseType:"blob"});case 2:i=e.sent,a=window.URL.createObjectURL(new Blob([i.data])),(r=document.createElement("a")).href=a,r.setAttribute("download",n),document.body.appendChild(r),r.click(),document.body.removeChild(r);case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),h=n(843),b=n(844),x=n(845),j=n(839),g=n(762),v=n(376),O=n.n(v),T=n(22),w=n(29),F=n(305),I=n(834),k=n(833),M=n(832),C=n(830),E=n(840),L=n(841),D=n(842),S=n(837),R=n(8),A=n(133),z=n(2);Object(R.h)({iconComponent:A.a});var P=function(e){var t=Object(i.useState)(null),n=Object(T.a)(t,2),a=n[0],r=n[1],o=Object(i.useState)(null),s=Object(T.a)(o,2),l=s[0],u=s[1],c=Object(i.useState)({path:[{index:0,name:"Root"}],index:0}),p=Object(T.a)(c,2),d=p[0],y=p[1],m=Object(i.useState)(null),f=Object(T.a)(m,2),h=f[0],b=f[1],x=Object(i.useState)([null]),j=Object(T.a)(x,2),g=j[0],v=j[1];Object(i.useEffect)((function(){!function(e,t,n,i){n([null]);var a=e.listFolders(t.index),r=e.listFolderFiles(t.index);Promise.all([a,r]).then((function(e){var t=e[0],i=e[1],a=t.map((function(e){return{id:e.folderIdx.toString(),name:e.name,isDir:!0}})),r=i.map((function(e){return{id:"".concat(e.folderIdx,"/").concat(e.name),name:e.name,isDir:!1}}));console.log(a.concat(r)),n(a.concat(r))})).catch((function(e){console.log(e),i({message:"".concat(e),severity:"error"})}))}(e.reefRepository,d,v,r)}),[d,e.reefRepository]);var O=Object(i.useState)(null),A=Object(T.a)(O,2),P=A[0],B=A[1];Object(i.useEffect)((function(){!function(e,t,n,i){null==t?n(null):(n([null]),e.listFiles(t).then((function(e){var t=e.map((function(e,t){return{id:"".concat(t,":").concat(e.uuid),name:e.name,modDate:e.lastModified,size:e.size,isDir:!1}}));n(t)})).catch((function(e){console.log(e),i({message:"".concat(e),severity:"error"})})))}(e.reefRepository,h,B,r)}),[h,e.reefRepository]);var N=function(e,t){return Object(i.useMemo)((function(){var n=e.path.map((function(e){return{id:e.index.toString(),name:e.name,isDir:!0}}));return null!=t&&n.push({id:"".concat(t.folderIdx,"/").concat(t.name),name:t.name+" (History)",isDir:!1}),console.log(n),n}),[e,t])}(d,h),_=function(e,t,n,a,r,o,s){return Object(i.useCallback)((function(i){if(i.id===R.a.OpenFiles.id){var l=i.payload,u=l.targetFile,c=l.files,p=null!==u&&void 0!==u?u:c[0];if(console.log(p),p)if(p.isDir){var d,y=!1,m=Object(F.a)(n.path.entries());try{for(m.s();!(d=m.n()).done;){var f=Object(T.a)(d.value,2),h=f[0];if(f[1].index.toString()===p.id){y=!0,r({path:n.path.slice(0,h+1),index:parseInt(p.id)}),o(null);break}}}catch(v){m.e(v)}finally{m.f()}y||(r({path:[].concat(Object(w.a)(n.path),[{index:parseInt(p.id),name:p.name}]),index:parseInt(p.id)}),o(null))}else if(t){a({message:"The file is now downloading...",severity:"info"});var b=p.id.split(":",2)[1];s({downloaded:!1,filename:p.name,hash:b}),e.downloadFile(b,p.name).then((function(){s({downloaded:!0,filename:p.name,hash:b}),a({message:"The file is downloaded.",severity:"success"})})).catch((function(e){console.log(e),s(null),a({message:"Download failed: ".concat(e),severity:"error"})}))}else{var x=p.id.split("/",1),j=Object(T.a)(x,1)[0],g=p.name;o({folderIdx:parseInt(j),name:g})}}console.log(i)}),[n.path,r,o,t,a,e,s])}(e.reefRepository,null!=h,d,r,y,b,u);return Object(z.jsxs)("div",{style:{height:"80vh"},children:[Object(z.jsxs)(R.c,{instanceId:e.instanceId,files:null!==P&&void 0!==P?P:g,folderChain:N,onFileAction:_,defaultFileViewActionId:R.a.EnableListView.id,children:[Object(z.jsx)(R.f,{}),Object(z.jsx)(R.g,{}),Object(z.jsx)(R.e,{}),Object(z.jsx)(R.d,{})]}),Object(z.jsx)(I.a,{open:null!==a,autoHideDuration:5e3,onClose:function(){r(null)},ClickAwayListenerProps:{onClickAway:function(){}},children:Object(z.jsx)(k.a,{onClose:function(){r(null)},severity:null===a||void 0===a?void 0:a.severity,sx:{width:"100%"},children:null===a||void 0===a?void 0:a.message})}),Object(z.jsxs)(M.a,{open:null!==l,maxWidth:!1,onClose:function(){u(null)},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(z.jsx)(C.a,{children:"Hash Digest"}),Object(z.jsxs)(E.a,{children:[Object(z.jsxs)(L.a,{children:["The file ",Object(z.jsx)("b",{children:null===l||void 0===l?void 0:l.filename})," is ",null!==l&&void 0!==l&&l.downloaded?"downloaded":"now downloading...","."]}),Object(z.jsxs)(L.a,{children:["The integrity of the file could be checked by comparing the ",Object(z.jsx)("code",{children:"sha256"})," digest."]}),Object(z.jsx)("br",{}),Object(z.jsx)(L.a,{children:Object(z.jsx)("b",{children:Object(z.jsx)("code",{children:null===l||void 0===l?void 0:l.hash})})}),Object(z.jsx)("br",{}),Object(z.jsxs)(L.a,{children:["You can use ",Object(z.jsx)("a",{href:"https://emn178.github.io/online-tools/sha256_checksum.html",target:"_blank",rel:"noreferrer",children:"this online tool"})," to compute the hash digest."]})]}),Object(z.jsx)(D.a,{children:Object(z.jsx)(S.a,{disabled:!(null!==l&&void 0!==l&&l.downloaded),onClick:function(){u(null)},autoFocus:!0,children:"Close"})})]})]})};var B=function(){var e=new f;return Object(z.jsxs)(h.a,{sx:{flexGrow:1},children:[Object(z.jsx)(b.a,{position:"static",children:Object(z.jsxs)(x.a,{children:[Object(z.jsx)(j.a,{size:"large",edge:"start",color:"inherit","aria-label":"menu",sx:{mr:2},children:Object(z.jsx)(O.a,{})}),Object(z.jsx)(g.a,{variant:"h6",component:"div",sx:{flexGrow:1},children:"Reef Blockchain Explorer"})]})}),Object(z.jsx)("div",{style:{padding:32},children:Object(z.jsx)(P,{instanceId:"reef-browser",reefRepository:e})})]})},N=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,848)).then((function(t){var n=t.getCLS,i=t.getFID,a=t.getFCP,r=t.getLCP,o=t.getTTFB;n(e),i(e),a(e),r(e),o(e)}))};Object(R.h)({iconComponent:A.a}),r.a.createRoot(document.getElementById("root")).render(Object(z.jsx)(B,{})),N()}},[[755,1,2]]]);
//# sourceMappingURL=main.575bf50b.chunk.js.map